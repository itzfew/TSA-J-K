<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quran Viewer</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="style.css">

</head>
<body>

  <h1>Quran Page Viewer</h1>

  <div id="ayahs">
    <!-- Ayah content will be dynamically added here -->
  </div>

  <div class="navigation">
    <button onclick="navigateToPage('prev')">Previous</button>
    <button onclick="navigateToPage('next')">Next</button>
  </div>

  <script>
    let selectedIdentifiers = ["ar.quran-uthmani", "en.ahmedraza", "ur.qadri"];

    function getPageFromUrl() {
      const params = new URLSearchParams(window.location.search);
      return parseInt(params.get('index'), 10) || 1;
    }

    function updateUrl(index) {
      const newUrl = `${window.location.origin}${window.location.pathname}?index=${index}`;
      history.pushState({}, '', newUrl);
    }

    async function fetchData(page, identifiers) {
      const promises = identifiers.map(identifier =>
        fetch(`https://api.alquran.cloud/v1/page/${page}/${identifier}`).then(response => response.json())
      );
      const results = await Promise.all(promises);
      return results.map(result => ({
        name: `${result.data.edition.englishName} (${result.data.edition.language})`,
        ayahs: result.data.ayahs,
      }));
    }

    function displayAyahs(data) {
      const ayahContainer = document.getElementById('ayahs');
      ayahContainer.innerHTML = '';

      const ayahCount = data[0].ayahs.length;

      for (let i = 0; i < ayahCount; i++) {
        const ayahElement = document.createElement('div');
        ayahElement.classList.add('ayah-container');

        data.forEach(translationData => {
          const ayah = translationData.ayahs[i];
          ayahElement.innerHTML += `
            <p class="identifier">${translationData.name}:</p>
            <p>${ayah.text}</p>
          `;
        });

        ayahElement.innerHTML += '<hr />';
        ayahContainer.appendChild(ayahElement);
      }
    }

    async function loadPage(page) {
      const data = await fetchData(page, selectedIdentifiers);
      displayAyahs(data);
    }

    function navigateToPage(direction) {
      let currentPage = getPageFromUrl();
      if (direction === 'prev' && currentPage > 1) currentPage--;
      if (direction === 'next') currentPage++;
      updateUrl(currentPage);
      loadPage(currentPage);
    }

    window.onload = () => {
      loadPage(getPageFromUrl());
    };
  </script>

</body>
</html>
